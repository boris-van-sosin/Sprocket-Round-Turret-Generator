<!DOCTYPE html>

<script src="RoundTurret.js"></script>
<!DOCTYPE html>
<html>
<title>Sprocket round turret generator</title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
<style>
  textarea {width: 100%;
	  height: 100%; 
	  box-sizing: border-box;}
</style>
<body class="w3-content" style="max-width:1300px">

<!-- First Grid: Logo & About -->
<div class="w3-row">
  <div class="w3-half w3-black w3-container w3-center" style="height:900px">
    <div class="w3-padding-64">
      <h1>Turret parameters</h1>
    </div>
    <div class="w3-padding-10" align="left">
	  <label>Turret diameter</label><br/>
      <input type="range" id="turretDiameter" name="turretDiameter" min="0.01" max="20" step="0.01" value="1" oninput="changeValue(this)"/>
	  <input type="number" id="turretDiameter" name="turretDiameter" min="0.01" max="20" step="0.01" value="1"  oninput="changeValue(this)"/><br/>
	  <p id="turretDiameterDisp" name="turretDiameterDisp">1</p>
    </div>
	<div class="w3-padding-10" align="left">
	  <label>Turret height coefficient</label><br/>
      <input type="range" id="turretHeightFactor" name="turretHeightFactor" min="0.01" max="20" step="0.01" value="0.5" oninput="changeValue(this)"/>
	  <input type="number" id="turretHeightFactor" name="turretHeightFactor" min="0.01" max="20" step="0.01" value="0.5"  oninput="changeValue(this)"/><br/>
	  <p id="turretHeightFactorDisp" name="turretHeightFactorDisp">0.5</p>
    </div>
    <div class="w3-padding-10" align="left">
	  <label>Number of segments (radial)</label><br/>
      <input type="range" id="turretNumSegs" name="turretNumSegs" min="1" max="60" step="1" value="12" oninput="changeValue(this)"/>
	  <input type="number" id="turretNumSegs" name="turretNumSegs" min="1" max="60" step="1" value="12"  oninput="changeValue(this)"/><br/>
	  <p id="turretNumSegsDisp" name="turretNumSegsDisp">12</p>
    </div>
    <div class="w3-padding-10" align="left">
	  <label>Elevation angles (in degrees, comma separated)</label><br/>
      <input type="text" id="turretHAngles" name="turretHAngles"/>
	  <p></p>
    </div>
    <div class="w3-padding-10" align="left">
	  <label>Offset</label>
	  <table>
	  <tr> 
      <td><label>X</label>&nbsp;</td>
	  <td><input type="range" id="turretOffsetX" name="turretOffsetX" min="-20" max="20" step="0.01" value="0" oninput="changeValue(this)"/>&nbsp;</td>
	  <td><input type="number" id="turretOffsetX" name="turretOffsetX" min="-20" max="20" step="0.01" value="0"  oninput="changeValue(this)"/>&nbsp;</td>  
	  <td><label id="turretOffsetXDisp" name="turretOffsetXDisp">0</label></td>
	  </tr>
	  
	  <tr> 
	  <td><label>Y</label>&nbsp;</td>
	  <td><input type="range" id="turretOffsetY" name="turretOffsetY" min="-20" max="20" step="0.01" value="0" oninput="changeValue(this)"/>&nbsp;</td>
	  <td><input type="number" id="turretOffsetY" name="turretOffsetY" min="-20" max="20" step="0.01" value="0" oninput="changeValue(this)"/></td>
	  <td><label id="turretOffsetYDisp" name="turretOffsetYDisp">0</label></td>
	  </tr>
	  
	  <tr> 
	  <td><label>Z</label>&nbsp;</td>
	  <td><input type="range" id="turretOffsetZ" name="turretOffsetZ" min="-20" max="20" step="0.01" value="0" oninput="changeValue(this)"/>&nbsp;</td>
	  <td><input type="number" id="turretOffsetZ" name="turretOffsetZ" min="-20" max="20" step="0.01" value="0" oninput="changeValue(this)"/></td>
	  <td><label id="turretOffsetZDisp" name="turretOffsetZDisp">0</label></td>
	  </tr>
	  </table>
	  <p></p>
    </div>
    <div class="w3-padding-10" align="left">
      <input type="button" id="generate" name="generate" value="Generate turret!" onclick="generate()"/>
    </div>
  </div>
  <div class="w3-half w3-blue-grey w3-container" style="height:900px">
    <div class="w3-padding-64 w3-center">
      <h1>Resulting code:</h1>
      <div class="w3-padding-10" style="height:600px" align="left">
        <textarea id="resText" name="resText" readonly>text</textarea>
      </div>
	  <div class="w3-padding-10" align="left">
		<input type="button" id="copyTxt" name="copyTxt" value="copy text"/>
	  </div>
    </div>
  </div>
</div>


<!-- Footer -->
<footer class="w3-container w3-black w3-padding-16">
  <p>Powered by <a href="https://www.w3schools.com/w3css/default.asp" target="_blank">w3.css</a></p>
</footer>

</body>
</html>

<script>
function changeValue(elem)
{
  let x = elem.value;
  if (x != "")
  {
	document.getElementById(elem.id + "Disp").innerHTML = x;
  }
}

function generate()
{
	let diameter = parseFloat(document.getElementById("turretDiameterDisp").innerHTML.trim());
	let heightFactor = parseFloat(document.getElementById("turretHeightFactorDisp").innerHTML.trim());
	let numSegs = parseInt(document.getElementById("turretNumSegsDisp").innerHTML.trim());
	let hAnglesStr = document.getElementById("turretHAngles").value;
	let offsetX = parseInt(document.getElementById("turretOffsetXDisp").innerHTML.trim());
	let offsetY = parseInt(document.getElementById("turretOffsetYDisp").innerHTML.trim());
	let offsetZ = parseInt(document.getElementById("turretOffsetZDisp").innerHTML.trim());
	
	var hAngles = [];
	let hAngleStrsSplit = hAnglesStr.split(",");
	for (let s in hAngleStrsSplit) {
		let currAngle = parseFloat(hAngleStrsSplit[s].trim());
		if (!isNaN(currAngle)) {
			hAngles.push(currAngle * Math.PI / 180);
		}
	}	
	
	console.log([diameter / 2, heightFactor, hAngles, numSegs, [offsetX, offsetY, offsetZ]]);
	
	let res = Dome(diameter / 2, heightFactor, hAngles, numSegs, [offsetX, offsetY, offsetZ]);
	console.log(res);
	document.getElementById("resText").innerHTML = JSON.stringify(res);
}
</script>